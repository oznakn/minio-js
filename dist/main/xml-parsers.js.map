{"version":3,"sources":["xml-parsers.js"],"names":["parseXml","xml","result","fxp","parse","Error","parseError","headerInfo","xmlErr","xmlObj","e","errors","S3Error","_","each","value","key","toLowerCase","parseCopyObject","etag","lastModified","xmlobj","CopyObjectResult","InvalidXMLError","ETag","replace","LastModified","Date","parseListMultipart","uploads","prefixes","isTruncated","ListMultipartUploadsResult","IsTruncated","NextKeyMarker","nextKeyMarker","NextUploadIdMarker","nextUploadIdMarker","CommonPrefixes","forEach","prefix","push","Prefix","Upload","upload","Key","uploadId","UploadId","initiator","id","Initiator","ID","displayName","DisplayName","owner","Owner","storageClass","StorageClass","initiated","Initiated","parseListBucket","ListAllMyBucketsResult","Buckets","Bucket","bucket","name","Name","creationDate","CreationDate","parseBucketNotification","TopicConfiguration","QueueConfiguration","CloudFunctionConfiguration","genEvents","events","s3event","genFilterRules","filters","S3Key","FilterRule","rule","Value","NotificationConfiguration","config","Id","Topic","Event","Filter","Queue","CloudFunction","parseBucketRegion","LocationConstraint","parseListParts","parts","marker","undefined","ListPartsResult","NextPartNumberMarker","Part","p","part","PartNumber","parseInitiateMultipart","InitiateMultipartUploadResult","parseCompleteMultipart","CompleteMultipartUploadResult","Location","location","Code","Message","errCode","errMessage","formatObjInfo","content","opts","Size","VersionId","IsLatest","size","versionId","isLatest","isDeleteMarker","IsDeleteMarker","parseListObjects","objects","nextMarker","nextVersionKeyMarker","parseCommonPrefixesEntity","responseEntity","commonPrefix","listBucketResult","ListBucketResult","listVersionsResult","ListVersionsResult","Contents","NextMarker","Version","DeleteMarker","NextVersionIdMarker","versionIdMarker","parseListObjectsV2","NextContinuationToken","nextContinuationToken","parseListObjectsV2WithMetadata","metadata","UserMetadata","parseBucketVersioningConfig","VersioningConfiguration","parseTagging","Tagging","TagSet","Tag","tagResult","parseLifecycleConfig","LifecycleConfiguration","parseObjectLockConfig","lockConfigResult","ObjectLockConfiguration","objectLockEnabled","ObjectLockEnabled","retentionResp","Rule","DefaultRetention","mode","Mode","isUnitYears","Years","validity","unit","RETENTION_VALIDITY_UNITS","YEARS","Days","DAYS","parseObjectRetentionConfig","retentionConfig","Retention","retainUntilDate","RetainUntilDate","parseBucketEncryptionConfig","encConfig","parseReplicationConfig","replicationConfig","ReplicationConfiguration","role","Role","rules","parseObjectLegalHoldConfig","LegalHold","uploadPartParser","respEl","CopyPartResult"],"mappings":"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","sourcesContent":["/*\n * MinIO Javascript Library for Amazon S3 Compatible Cloud Storage, (C) 2015 MinIO, Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport fxp from 'fast-xml-parser'\nimport _ from 'lodash'\nimport * as errors from './errors.js'\nimport {\n  isObject,\n  sanitizeETag,\n  toArray,\n  sanitizeObjectKey,\n  RETENTION_VALIDITY_UNITS\n} from \"./helpers\"\n\nvar parseXml = (xml) => {\n  var result = null\n  result = fxp.parse(xml)\n  if (result.Error) {\n    throw result.Error\n  }\n\n  return result\n}\n\n// Parse XML and return information as Javascript types\n\n// parse error XML response\nexport function parseError(xml, headerInfo) {\n  var xmlErr = {}\n  var xmlObj = fxp.parse(xml)\n  if (xmlObj.Error) {\n    xmlErr =  xmlObj.Error\n  }\n\n  var e = new errors.S3Error()\n  _.each(xmlErr, (value, key) => {\n    e[key.toLowerCase()] = value\n  })\n\n  _.each(headerInfo, (value, key) => {\n    e[key] = value\n  })\n  return e\n}\n\n// parse XML response for copy object\nexport function parseCopyObject(xml) {\n  var result = {\n    etag: \"\",\n    lastModified: \"\"\n  }\n\n  var xmlobj = parseXml(xml)\n  if (!xmlobj.CopyObjectResult) {\n    throw new errors.InvalidXMLError('Missing tag: \"CopyObjectResult\"')\n  }\n  xmlobj = xmlobj.CopyObjectResult\n  if (xmlobj.ETag) result.etag = xmlobj.ETag.replace(/^\"/g, '').replace(/\"$/g, '')\n    .replace(/^&quot;/g, '').replace(/&quot;$/g, '')\n    .replace(/^&#34;/g, '').replace(/&#34;$/g, '')\n  if (xmlobj.LastModified) result.lastModified = new Date(xmlobj.LastModified)\n\n  return result\n}\n\n// parse XML response for listing in-progress multipart uploads\nexport function parseListMultipart(xml) {\n  var result = {\n    uploads: [],\n    prefixes: [],\n    isTruncated: false\n  }\n\n  var xmlobj = parseXml(xml)\n\n  if (!xmlobj.ListMultipartUploadsResult) {\n    throw new errors.InvalidXMLError('Missing tag: \"ListMultipartUploadsResult\"')\n  }\n  xmlobj = xmlobj.ListMultipartUploadsResult\n  if (xmlobj.IsTruncated) result.isTruncated = xmlobj.IsTruncated\n  if (xmlobj.NextKeyMarker) result.nextKeyMarker =  xmlobj.NextKeyMarker\n  if (xmlobj.NextUploadIdMarker) result.nextUploadIdMarker = xmlobj.nextUploadIdMarker\n\n  if (xmlobj.CommonPrefixes) {\n    toArray(xmlobj.CommonPrefixes).forEach(prefix => {\n      result.prefixes.push({prefix: sanitizeObjectKey(toArray(prefix.Prefix)[0])})\n    })\n  }\n\n  if (xmlobj.Upload) {\n    toArray(xmlobj.Upload).forEach(upload => {\n      var key = upload.Key\n      var uploadId = upload.UploadId\n      var initiator = {id: upload.Initiator.ID, displayName: upload.Initiator.DisplayName}\n      var owner = {id: upload.Owner.ID, displayName: upload.Owner.DisplayName}\n      var storageClass = upload.StorageClass\n      var initiated = new Date(upload.Initiated)\n      result.uploads.push({key, uploadId, initiator, owner, storageClass, initiated})\n    })\n  }\n  return result\n}\n\n// parse XML response to list all the owned buckets\nexport function parseListBucket(xml) {\n  var result = []\n  var xmlobj = parseXml(xml)\n\n  if (!xmlobj.ListAllMyBucketsResult) {\n    throw new errors.InvalidXMLError('Missing tag: \"ListAllMyBucketsResult\"')\n  }\n  xmlobj = xmlobj.ListAllMyBucketsResult\n\n  if (xmlobj.Buckets) {\n    if (xmlobj.Buckets.Bucket) {\n      toArray(xmlobj.Buckets.Bucket).forEach(bucket => {\n        var name = bucket.Name\n        var creationDate = new Date(bucket.CreationDate)\n        result.push({name, creationDate})\n      })\n    }\n  }\n  return result\n}\n\n// parse XML response for bucket notification\nexport function parseBucketNotification(xml) {\n  var result = {\n    TopicConfiguration  : [],\n    QueueConfiguration  : [],\n    CloudFunctionConfiguration : [],\n  }\n  // Parse the events list\n  var genEvents = function(events) {\n    var result = []\n    if (events) {\n      toArray(events).forEach(s3event => {\n        result.push(s3event)\n      })\n    }\n    return result\n  }\n  // Parse all filter rules\n  var genFilterRules = function(filters) {\n    var result = []\n    if (filters) {\n      filters = toArray(filters)\n      if (filters[0].S3Key) {\n        filters[0].S3Key = toArray(filters[0].S3Key)\n        if (filters[0].S3Key[0].FilterRule) {\n          toArray(filters[0].S3Key[0].FilterRule).forEach(rule => {\n            var Name = toArray(rule.Name)[0]\n            var Value = toArray(rule.Value)[0]\n            result.push({Name, Value})\n          })\n        }\n      }\n    }\n    return result\n  }\n\n  var xmlobj = parseXml(xml)\n  xmlobj = xmlobj.NotificationConfiguration\n\n  // Parse all topic configurations in the xml\n  if (xmlobj.TopicConfiguration) {\n    toArray(xmlobj.TopicConfiguration).forEach(config => {\n      var Id = toArray(config.Id)[0]\n      var Topic = toArray(config.Topic)[0]\n      var Event = genEvents(config.Event)\n      var Filter = genFilterRules(config.Filter)\n      result.TopicConfiguration.push({ Id, Topic, Event, Filter})\n    })\n  }\n  // Parse all topic configurations in the xml\n  if (xmlobj.QueueConfiguration) {\n    toArray(xmlobj.QueueConfiguration).forEach(config => {\n      var Id = toArray(config.Id)[0]\n      var Queue = toArray(config.Queue)[0]\n      var Event = genEvents(config.Event)\n      var Filter = genFilterRules(config.Filter)\n      result.QueueConfiguration.push({ Id, Queue, Event, Filter})\n    })\n  }\n  // Parse all QueueConfiguration arrays\n  if (xmlobj.CloudFunctionConfiguration) {\n    toArray(xmlobj.CloudFunctionConfiguration).forEach(config => {\n      var Id = toArray(config.Id)[0]\n      var CloudFunction = toArray(config.CloudFunction)[0]\n      var Event = genEvents(config.Event)\n      var Filter = genFilterRules(config.Filter)\n      result.CloudFunctionConfiguration.push({ Id, CloudFunction, Event, Filter})\n    })\n  }\n\n  return result\n}\n\n// parse XML response for bucket region\nexport function parseBucketRegion(xml) {\n  // return region information\n  return parseXml(xml).LocationConstraint\n}\n\n// parse XML response for list parts of an in progress multipart upload\nexport function parseListParts(xml) {\n  var xmlobj = parseXml(xml)\n  var result = {\n    isTruncated: false,\n    parts: [],\n    marker: undefined\n  }\n  if (!xmlobj.ListPartsResult) {\n    throw new errors.InvalidXMLError('Missing tag: \"ListPartsResult\"')\n  }\n  xmlobj = xmlobj.ListPartsResult\n  if (xmlobj.IsTruncated) result.isTruncated = xmlobj.IsTruncated\n  if (xmlobj.NextPartNumberMarker) result.marker = +toArray(xmlobj.NextPartNumberMarker)[0]\n  if (xmlobj.Part) {\n    toArray(xmlobj.Part).forEach(p => {\n      var part = + toArray(p.PartNumber)[0]\n      var lastModified = new Date(p.LastModified)\n      var etag = p.ETag.replace(/^\"/g, '').replace(/\"$/g, '')\n        .replace(/^&quot;/g, '').replace(/&quot;$/g, '')\n        .replace(/^&#34;/g, '').replace(/&#34;$/g, '')\n      result.parts.push({part, lastModified, etag})\n    })\n  }\n  return result\n}\n\n// parse XML response when a new multipart upload is initiated\nexport function parseInitiateMultipart(xml) {\n  var xmlobj = parseXml(xml)\n\n  if (!xmlobj.InitiateMultipartUploadResult) {\n    throw new errors.InvalidXMLError('Missing tag: \"InitiateMultipartUploadResult\"')\n  }\n  xmlobj = xmlobj.InitiateMultipartUploadResult\n\n  if (xmlobj.UploadId) return xmlobj.UploadId\n  throw new errors.InvalidXMLError('Missing tag: \"UploadId\"')\n}\n\n// parse XML response when a multipart upload is completed\nexport function parseCompleteMultipart(xml) {\n  var xmlobj = parseXml(xml).CompleteMultipartUploadResult\n  if (xmlobj.Location) {\n    var location = toArray(xmlobj.Location)[0]\n    var bucket = toArray(xmlobj.Bucket)[0]\n    var key = xmlobj.Key\n    var etag = xmlobj.ETag.replace(/^\"/g, '').replace(/\"$/g, '')\n      .replace(/^&quot;/g, '').replace(/&quot;$/g, '')\n      .replace(/^&#34;/g, '').replace(/&#34;$/g, '')\n\n    return {location, bucket, key, etag}\n  }\n  // Complete Multipart can return XML Error after a 200 OK response\n  if (xmlobj.Code && xmlobj.Message) {\n    var errCode = toArray(xmlobj.Code)[0]\n    var errMessage = toArray(xmlobj.Message)[0]\n    return {errCode, errMessage}\n  }\n}\n\nconst formatObjInfo = (content, opts={}) => {\n\n  let {\n    Key,\n    LastModified,\n    ETag,\n    Size,\n    VersionId,\n    IsLatest\n  } = content\n    \n  if(!isObject(opts)){\n    opts = {}\n  }\n\n  const name = sanitizeObjectKey(toArray(Key)[0])\n  const lastModified = new Date(toArray(LastModified)[0])\n  const etag = sanitizeETag(toArray(ETag)[0])\n\n  return {\n    name,\n    lastModified,\n    etag,\n    size:Size,\n    versionId:VersionId,\n    isLatest:IsLatest,\n    isDeleteMarker:opts.IsDeleteMarker ? opts.IsDeleteMarker: false\n  }\n}\n\n// parse XML response for list objects in a bucket\nexport function parseListObjects(xml) {\n  var result = {\n    objects: [],\n    isTruncated: false\n  }\n  let isTruncated = false\n  let nextMarker, nextVersionKeyMarker\n  const xmlobj = parseXml(xml)\n\n  const parseCommonPrefixesEntity = responseEntity => {\n    if(responseEntity){\n      toArray(responseEntity).forEach((commonPrefix) => {\n        result.objects.push({prefix: sanitizeObjectKey(toArray(commonPrefix.Prefix)[0]), size: 0})\n      })\n    }\n  }\n\n  const listBucketResult = xmlobj.ListBucketResult\n  const listVersionsResult=xmlobj.ListVersionsResult\n\n  if(listBucketResult){\n    if ( listBucketResult.IsTruncated) {\n      isTruncated = listBucketResult.IsTruncated\n    }\n    if (listBucketResult.Contents) {\n      toArray(listBucketResult.Contents).forEach(content => {\n        const name = sanitizeObjectKey(toArray(content.Key)[0])\n        const lastModified = new Date(toArray(content.LastModified)[0])\n        const etag = sanitizeETag(toArray(content.ETag)[0])\n        const size = content.Size\n        result.objects.push({name, lastModified, etag, size})\n      })\n    }\n    \n    if( listBucketResult.NextMarker){\n      nextMarker = listBucketResult.NextMarker\n    }\n    parseCommonPrefixesEntity(listBucketResult.CommonPrefixes)\n  }\n    \n  if(listVersionsResult){\n    if(listVersionsResult.IsTruncated){\n      isTruncated = listVersionsResult.IsTruncated\n    }\n\n    if (listVersionsResult.Version) {\n      toArray(listVersionsResult.Version).forEach(content => {\n        result.objects.push(formatObjInfo(content))\n      })\n    }\n    if (listVersionsResult.DeleteMarker) {\n      toArray(listVersionsResult.DeleteMarker).forEach(content => {\n        result.objects.push(formatObjInfo(content, {IsDeleteMarker:true}))\n      })\n    }\n\n    if (listVersionsResult.NextKeyMarker) {\n      nextVersionKeyMarker = listVersionsResult.NextKeyMarker\n    }\n    if (listVersionsResult.NextVersionIdMarker) {\n      result.versionIdMarker = listVersionsResult.NextVersionIdMarker\n    }\n    parseCommonPrefixesEntity(listVersionsResult.CommonPrefixes)\n  }\n\n  result.isTruncated= isTruncated\n  if (isTruncated) {\n    result.nextMarker = nextVersionKeyMarker || nextMarker\n  }\n  return result\n}\n\n// parse XML response for list objects v2 in a bucket\nexport function parseListObjectsV2(xml) {\n  var result = {\n    objects: [],\n    isTruncated: false\n  }\n  var xmlobj = parseXml(xml)\n  if (!xmlobj.ListBucketResult) {\n    throw new errors.InvalidXMLError('Missing tag: \"ListBucketResult\"')\n  }\n  xmlobj = xmlobj.ListBucketResult\n  if (xmlobj.IsTruncated) result.isTruncated = xmlobj.IsTruncated\n  if (xmlobj.NextContinuationToken) result.nextContinuationToken = xmlobj.NextContinuationToken\n  if (xmlobj.Contents) {\n    toArray(xmlobj.Contents).forEach(content => {\n      var name = sanitizeObjectKey(toArray(content.Key)[0])\n      var lastModified = new Date(content.LastModified)\n      var etag = sanitizeETag(content.ETag)\n      var size = content.Size\n      result.objects.push({name, lastModified, etag, size})\n    })\n  }\n  if (xmlobj.CommonPrefixes) {\n    toArray(xmlobj.CommonPrefixes).forEach(commonPrefix => {\n      result.objects.push({prefix: sanitizeObjectKey(toArray(commonPrefix.Prefix)[0]), size:0})\n    })\n  }\n  return result\n}\n\n// parse XML response for list objects v2 with metadata in a bucket\nexport function parseListObjectsV2WithMetadata(xml) {\n  var result = {\n    objects: [],\n    isTruncated: false\n  }\n  var xmlobj = parseXml(xml)\n  if (!xmlobj.ListBucketResult) {\n    throw new errors.InvalidXMLError('Missing tag: \"ListBucketResult\"')\n  }\n  xmlobj = xmlobj.ListBucketResult\n  if (xmlobj.IsTruncated) result.isTruncated = xmlobj.IsTruncated\n  if (xmlobj.NextContinuationToken) result.nextContinuationToken = xmlobj.NextContinuationToken\n\n  if (xmlobj.Contents) {\n    toArray(xmlobj.Contents).forEach(content => {\n      var name = sanitizeObjectKey(content.Key)\n      var lastModified = new Date(content.LastModified)\n      var etag = sanitizeETag(content.ETag)\n      var size = content.Size\n      var metadata\n      if (content.UserMetadata != null) {\n        metadata = toArray(content.UserMetadata)[0]\n      } else {\n        metadata = null\n      }\n      result.objects.push({name, lastModified, etag, size, metadata})\n    })\n  }\n\n  if (xmlobj.CommonPrefixes) {\n    toArray(xmlobj.CommonPrefixes).forEach(commonPrefix => {\n      result.objects.push({prefix: sanitizeObjectKey(toArray(commonPrefix.Prefix)[0]), size:0})\n    })\n  }\n  return result\n}\n\nexport function parseBucketVersioningConfig(xml){\n  var xmlObj = parseXml(xml)\n  return xmlObj.VersioningConfiguration\n}\n\nexport function parseTagging(xml){\n  const xmlObj = parseXml(xml)\n  let result =[]\n  if(xmlObj.Tagging && xmlObj.Tagging.TagSet&& xmlObj.Tagging.TagSet.Tag){\n    const tagResult = xmlObj.Tagging.TagSet.Tag\n    // if it is a single tag convert into an array so that the return value is always an array.\n    if(isObject(tagResult)){\n      result.push(tagResult)\n    }else{\n      result = tagResult\n    }\n  }\n  return result\n}\n\nexport function parseLifecycleConfig(xml){\n  const xmlObj = parseXml(xml)\n  return xmlObj.LifecycleConfiguration\n}\n\n\nexport function parseObjectLockConfig(xml){\n  const xmlObj = parseXml(xml)\n  let lockConfigResult={}\n  if(xmlObj.ObjectLockConfiguration) {\n    lockConfigResult = {\n      objectLockEnabled:  xmlObj.ObjectLockConfiguration.ObjectLockEnabled\n    }\n    let retentionResp\n    if(xmlObj.ObjectLockConfiguration && xmlObj.ObjectLockConfiguration.Rule && xmlObj.ObjectLockConfiguration.Rule.DefaultRetention){\n      retentionResp = xmlObj.ObjectLockConfiguration.Rule.DefaultRetention || {}\n      lockConfigResult.mode= retentionResp.Mode\n    }\n    if(retentionResp) {\n      const isUnitYears = retentionResp.Years\n      if (isUnitYears) {\n        lockConfigResult.validity = isUnitYears\n        lockConfigResult.unit = RETENTION_VALIDITY_UNITS.YEARS\n      } else {\n        lockConfigResult.validity = retentionResp.Days\n        lockConfigResult.unit = RETENTION_VALIDITY_UNITS.DAYS\n      }\n    }\n    return lockConfigResult\n  }\n}\n\n\nexport function parseObjectRetentionConfig(xml){\n  const xmlObj = parseXml(xml)\n  const retentionConfig = xmlObj.Retention\n\n  return {\n    mode:retentionConfig.Mode,\n    retainUntilDate:retentionConfig.RetainUntilDate\n  }\n}\n\nexport function  parseBucketEncryptionConfig(xml){\n  let encConfig = parseXml(xml)\n  return encConfig\n}\nexport function parseReplicationConfig(xml){\n  const xmlObj = parseXml(xml)\n  const replicationConfig = {\n    ReplicationConfiguration: {\n      role: xmlObj.ReplicationConfiguration.Role,\n      rules: toArray(xmlObj.ReplicationConfiguration.Rule)\n    }\n  }\n  return replicationConfig\n}\n\nexport function  parseObjectLegalHoldConfig(xml){\n  const xmlObj = parseXml(xml)\n  return xmlObj.LegalHold\n}\n\nexport function uploadPartParser (xml){\n  const xmlObj = parseXml(xml)\n  const respEl = xmlObj.CopyPartResult\n  return respEl\n}"],"file":"xml-parsers.js"}